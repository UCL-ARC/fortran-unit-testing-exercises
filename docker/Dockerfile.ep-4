FROM ghcr.io/ucl-arc/fortran-unit-testing-exercises:main

COPY --chown=vscode episodes/4-fortran-unit-test-syntax /home/vscode/4-fortran-unit-test-syntax

WORKDIR /home/vscode/4-fortran-unit-test-syntax/solution

# build tests with cmake
RUN cmake -B build -DCMAKE_PREFIX_PATH=/home/vscode/pfunit/build/installed && \
    cmake --build build

# test pfunit with ctest
RUN ctest --test-dir build --output-on-failure

